# File organization

## Executables (under ./bin/): contains java class, shell scripts, python script
* `generatingGausianMeansAL5Copies.class`   // generate Gaussian means for different genotypes and prevalence levels
* `generatingGausianMeansAL5CopiesNoCNAs.class`  // generate Gaussian means for different genotypes and prevalence levels when there is no CNA event
* `updateOffDiagonalElementsForEMUntieVariances.class`  // update the diagonal elements in the transition matrices
* `llRat.py` // compare log-likelihood with that from last iteration 
* `trainTest.sh`  // main function of training and inference of THEMIS model
* `tri.sh`  // triangulation of the graph, a necessary step before training and inference of DBN

## Source code (under ./src/):  java code for file generation
* `generatingGausianMeansAL5Copies.java`  // generate Gaussian means for different genotypes and prevalence levels
* `generatingGausianMeansAL5CopiesNoCNAs.java`  // generate Gaussian means for different genotypes and prevalence levels when there is no CNA event
* `updateOffDiagonalElementsForEMUntieVariances.java`  // update the diagonal elements in the transition matrices

## Dataset (under ./data/): 
Example dataset used by THEMIS is `combinedData_01-1-B2_01-2-B2_01-4-B3.txt`

## Documentation (under ./doc/): 
The documentation of the source code and model specification files are provided in `doc.md`

## Model specification files (under ./model/):
* `hmm_factorialModel.mtr`  // master file which specifies the parameter of the DBN
* `hmm_factorialModel.str`  // structure file which specifies the structure of the DBN
* `constants.inc`  // constant used in the structure file and master file
* `initCovars.txt`  // initial values for covariance in the Gaussians
* `initDpmfs.txt`  // initial values for Gaussian mixtures
* `init_hmm_factorialModel.params`  // initial values for other parameters
* `params.notrain`  // which parameters are not to be estimated. If a parameter is specified in this file, it will be fixed at its initial value rather than being estimated

Other files under model directory are generated from java codes, gmtk triangulation,
* `random.gmp`  // automatically generated if GMTK is asked to randomly initialize unspecified parameters
* `hmm_factorialModel.str.trifile`  // automatically generated by GMTK during triangulation
* `train_hmm_factorialModel.mtr`  // intermediate master file used in iterations, not specified by the users
* `em_covar.txt` // current estimate of the transition parameters \sigma^2_{G,j} and \sigma^2_{Z,j}. The first |G| rows are for \sigma^2_{G,j} and the next |Z| rows are for \sigma^2_{Z,j} (usually initialized as 100).
* `em_training_data.txt` // the directory and file name of the input data for GMTK. Note that java code updateOffDiagonalElementsForEMUntieVariances.class takes combinedData_01-1-B2_01-2-B2_01-4-B3.txt and em_covar.txt as input and writes to data into the data file specified by em_training_data.txt.

Other files are for specifying Gaussian distributions, automatically generated from java classes under bin


## Tutorial (under ./tutorial/)


## Output from THEMIS (under ./out/)

* `hmm_factorialModel_vitVals.txt`  // Viterbi path inferred from GMTK, which contains the genotype at each genomic site and the clone in which the mutation occurs
* `curr.txt`  // output from GMTK
* `em_covar.txt`  // estimated parameters for transition of G and Z variables
* `err.txt`  // errors from GMTK
* `jt_info.txt`  // junction tree, automatically generated by GMTK
* `ll_iter{k}.txt`  // log likelihood yielded in the k-th iteration  
* `trained_factorialModel_{k}.params`  // parameters estimated in the k-th iteration  


## Directory and file explanation are explained in  `readme.md`

## Our manuscript can be accessed via http://biorxiv.org/content/early/2017/04/06/125138

